---
import { getCollection, type CollectionEntry } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import PageBanner from '../../components/PageBanner.astro';
import { Image } from 'astro:assets';
import type { ImageMetadata } from 'astro';

export async function getStaticPaths() {
  const potensiEntries = await getCollection('potensi');
  return potensiEntries.map(entry => ({
    params: { slug: entry.slug },
    props: { entry },
  }));
}

const { entry } = Astro.props as { entry: CollectionEntry<'potensi'> };
const { data } = entry;
const allImages = await import.meta.glob<{ default: ImageMetadata }>('/src/assets/images/**/*.{jpeg,jpg,png,gif,webp,svg}');
const imagePath = Object.keys(allImages).find(path => path.endsWith(data.gambarUrl));
---
<Layout title={data.judul} description={data.deskripsi}>
    <Header currentPage="Potensi" />
    <main>
        <PageBanner
            title={data.judul}
            subtitle="Produk Unggulan Dusun Bedalo"
            bgColor="bg-green-600"
        />

        <section class="py-20 bg-white">
            <div class="container mx-auto px-6 max-w-4xl">
                
                {/* --- BACK BUTTON ADDED HERE --- */}
                <div class="mb-8">
                    <a href="/potensi" class="inline-flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors font-semibold">
                        <i class="fas fa-arrow-left"></i>
                        Kembali ke Daftar Potensi
                    </a>
                </div>
       
                <div class="grid md:grid-cols-2 gap-12 items-center">
                    <div data-aos="fade-right">
                        {imagePath && (
                            <Image
                                src={allImages[imagePath]()}
                                alt={data.altText}
                                width="800"
                                height="600"
                                class="rounded-xl shadow-lg w-full h-full object-cover"
                            />
                        )}
                    </div>
                    <div data-aos="fade-left">
                        <h2 class="text-3xl font-bold text-gray-800 mb-4">{data.judul}</h2>
                        <p class="text-gray-600 leading-relaxed mb-4">{data.deskripsi}</p>
                        <div class="mb-6">
                            <span class="text-sm text-gray-500">Harga:</span>
                            <p class="text-2xl font-bold text-green-600">{data.harga}</p>
                        </div>
                        <div class="flex flex-wrap gap-4">
                            <a href={data.kontakLink} target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center gap-2 text-white bg-green-500 px-6 py-3 rounded-md hover:bg-green-600 transition-colors font-semibold">
                                <i class="fab fa-whatsapp"></i> Hubungi Penjual
                            </a>
                             <a href={data.petaLink} target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center gap-2 text-white bg-gray-600 px-6 py-3 rounded-md hover:bg-gray-700 transition-colors font-semibold">
                                <i class="fas fa-map-marker-alt"></i> Lihat Lokasi
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>
    <Footer />
</Layout>